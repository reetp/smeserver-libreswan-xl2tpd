#! /usr/bin/perl -w

# Need some thought on when the templates should be expanded and when the action should be called.

use esmith::Build::CreateLinks qw(:all);
my $event = "ip-up.xl2tpd";

foreach (qw(
       /etc/ipsec.conf
       /etc/ipsec.d/xl2tpd.conf
       /etc/ipsec.d/xl2tpd.secrets
    ))
{
    templates2events("$_", qw(
    post-upgrade
    console-save
    bootstrap-console-save
    remoteaccess-update
    ipsec-update
    ip-up.xl2tpd
    ));
}

#--------------------------------------------------
# actions for ipsec-update event
#--------------------------------------------------

# Runlevel init links.
service_link_enhanced("xl2tpd", "S95", "7");
service_link_enhanced("xl2tpd", "K21", "6");
service_link_enhanced("xl2tpd", "K21", "0");
service_link_enhanced("xl2tpd", "K21", "1");


safe_symlink("adjust", "root/etc/e-smith/events/$event/services2adjust/masq");
