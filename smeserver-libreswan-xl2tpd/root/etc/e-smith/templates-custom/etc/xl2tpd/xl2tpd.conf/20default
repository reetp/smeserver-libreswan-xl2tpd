
{
	use strict;
	use warnings;
	use esmith::ConfigDB;

    my $configDB = esmith::ConfigDB->open_ro or die ("can't open Config DB");

    my $ipsecDB = esmith::ConfigDB->open_ro('ipsec_connections') or die ("cant connect to ipsec database");

    my $InternalIP = $configDB->get_prop("InternalInterface", IPAddress);

    my $ipRangeStart = $ipsecDB->get_prop("L2TP-PSK", "IPRangeStart");
    my $ipRangeFinish = $ipsecDB->get_prop("L2TP-PSK", "IPRangeFinish");

    $Out .= "[lns default]\n";
    $OUT .= "name=L2TP-VPN\n";

    $OUT .= "ip range = $ipRangeStart - $ipRangeFinish\n";

    $OUT .= "local ip = $InternalIP\n";
    $OUT .= "unix authentication = yes";
    $OUT .= "require authentication = yes";
    $OUT .= "ppp debug = yes"
    $OUT .= "pppoptfile = /etc/ppp/options.xl2tpd";
    $OUT .= "length bit = yes";

}
